{% macro render_field(name, id, label_text, class='form-control', type='text', required=False, value=None) %}
    <div class="mb-3">
        <label for="{{ id }}" class="form-label">{{ label_text }}</label>
        {% if type == 'textarea' %}
            <textarea name="{{ name }}" id="{{ id }}" class="{{ class }}" {% if required %}required{% endif %}>{{ value or '' }}</textarea>
        {% else %}
            <input type="{{ type }}" name="{{ name }}" id="{{ id }}" class="{{ class }}" value="{{ value or '' }}" {% if required %}required{% endif %}>
        {% endif %}
    </div>
{% endmacro %}

{% macro render_select_field(name, id, label_text, options, selected_value=None) %}
    <div class="mb-3">
        <label for="{{ id }}" class="form-label">{{ label_text }}</label>
        <select name="{{ name }}" id="{{ id }}" class="form-control">
            {% for value, text in options %}
                <option value="{{ value }}" {% if selected_value == value %}selected{% endif %}>{{ text }}</option>
            {% endfor %}
        </select>
    </div>
{% endmacro %}

{% macro render_submit_button(text, class='btn btn-primary', id=None) %}
    <button type="submit" class="{{ class }}" {% if id %}id="{{ id }}"{% endif %}>{{ text }}</button>
{% endmacro %}

{% macro render_csrf_token(id='csrf_token') %}
    <input type="hidden" name="csrf_token" id="{{ id }}" value="{{ csrf_token() }}">
{% endmacro %}

{% macro render_rule_list(items, prefix, edit_endpoint, remove_endpoint) %}
    <ul id="RulesList" class="list-group">
        {% for item in items %}
            {% set description = item.description if item.description is defined else item.role_name %}
            {% set points = item.points if item.points is defined else None %}
            {% set safe_description = description|lower|replace(' ', '_')|replace('[^a-z0-9_]', '') %}
            <li class="list-group-item" data-description="{{ description }}">
                {{ description }}
                {% if points is not none %}
                    : {{ points }} points
                {% endif %}
                <form class="edit-rule-form" action="{{ url_for(edit_endpoint) }}" method="POST" style="display:inline;">
                    {{ render_csrf_token(id='edit_rule_csrf_' + safe_description) }}
                    {{ render_field(name='new_description' if points is not none else 'new_role_name', id='edit_rule_description_' + safe_description, label_text='Description', class='form-control', required=True, value=description) }}
                    {% if points is not none %}
                        {{ render_field(name='points', id='edit_rule_points_' + safe_description, label_text='Points', class='form-control', type='number', required=True, value=points) }}
                    {% else %}
                        {{ render_field(name='percentage', id='edit_rule_percentage_' + safe_description, label_text='Percentage', class='form-control', type='number', required=True, value=item.percentage if item.percentage is defined else '') }}
                    {% endif %}
                    {{ render_submit_button('Edit', class='btn btn-primary btn-sm') }}
                </form>
                <form class="remove-rule-form" action="{{ url_for(remove_endpoint) }}" method="POST" style="display:inline;">
                    {{ render_csrf_token(id='remove_rule_csrf_' + safe_description) }}
                    {{ render_submit_button('Remove', class='btn btn-danger btn-sm') }}
                </form>
            </li>
        {% endfor %}
    </ul>
{% endmacro %}

{% macro render_voting_results(voting_results, is_admin) %}
    <table class="table">
        <thead>
            {% if is_admin %}
                <tr>
                    <th>Voter Initials</th>
                    <th>Recipient</th>
                    <th>Vote Value</th>
                    <th>Points</th>
                    <th>Date</th>
                </tr>
            {% else %}
                <tr>
                    <th>Week</th>
                    <th>Recipient</th>
                    <th>+1 Votes</th>
                    <th>-1 Votes</th>
                    <th>Points</th>
                </tr>
            {% endif %}
        </thead>
        <tbody>
            {% for result in voting_results %}
                <tr>
                    {% if is_admin %}
                        <td>{{ result.voter_initials }}</td>
                        <td>{{ result.recipient_name }}</td>
                        <td>{{ result.vote_value }}</td>
                        <td>{{ result.points }}</td>
                        <td>{{ result.vote_date }}</td>
                    {% else %}
                        <td>{{ result.week_number }}</td>
                        <td>{{ result.recipient_name }}</td>
                        <td>{{ result.plus_votes }}</td>
                        <td>{{ result.minus_votes }}</td>
                        <td>{{ result.points }}</td>
                    {% endif %}
                </tr>
            {% else %}
                <tr>
                    <td colspan="5">No voting results available</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endmacro %}

{% macro render_feedback_table(feedback, prefix, mark_read_endpoint) %}
    <table class="table">
        <thead>
            <tr>
                <th>Comment</th>
                <th>Submitter</th>
                <th>Timestamp</th>
                <th>Read</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for item in feedback %}
                <tr>
                    <td>{{ item.comment }}</td>
                    <td>{{ item.submitter }}</td>
                    <td>{{ item.timestamp }}</td>
                    <td>{{ 'Yes' if item.read else 'No' }}</td>
                    <td>
                        {% if not item.read %}
                            <form action="{{ url_for(mark_read_endpoint) }}" method="POST" style="display:inline;">
                                {{ render_csrf_token(id='mark_feedback_csrf_' + item.id|string) }}
                                {{ render_submit_button('Mark Read', class='btn btn-primary btn-sm') }}
                            </form>
                        {% endif %}
                        <form action="{{ url_for('admin_delete_feedback', feedback_id=item.id) }}" method="POST" style="display:inline;">
                            {{ render_csrf_token(id='delete_feedback_csrf_' + item.id|string) }}
                            {{ render_submit_button('Delete', class='btn btn-danger btn-sm') }}
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="5">No feedback available</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endmacro %}

{% macro render_multi_select(name, id, options) %}
    <div class="mb-3">
        <label for="{{ id }}" class="form-label">Select Days</label>
        <select name="{{ name }}" id="{{ id }}" class="form-control" multiple>
            {% for value, text in options %}
                <option value="{{ value }}">{{ text }}</option>
            {% endfor %}
        </select>
    </div>
{% endmacro %}
{# Version: 1.2.9 #}
{# Note: Updated render_field to include proper <input> and <textarea> tags with attributes. Enhanced render_select_field with <option> tags and selected_value support. Improved render_rule_list with structured <ul> and inline forms. Ensured compatibility with admin_manage.html (1.2.26), incentive.html (1.2.21), quick_adjust.html (1.2.10), app.py (1.2.50), forms.py (1.2.4), config.py (1.2.5), script.js (1.2.35), style.css (1.2.14), base.html (1.2.21), start_voting.html (1.2.4), settings.html (1.2.5), admin_login.html (1.2.5). No removal of core functionality. #}