{% extends "base.html" %}
{% block content %}
<h1>Quick Point Adjustment</h1>
<form id="quickAdjustForm" action="{{ url_for('admin_quick_adjust_points') }}" method="POST">
    <input type="hidden" name="csrf_token" id="csrf_token_quick_adjust" value="{{ csrf_token() }}">
    <div class="mb-3">
        <label for="username" class="form-label">Admin Username:</label>
        <input type="text" class="form-control" id="username" name="username" required>
    </div>
    <div class="mb-3">
        <label for="password" class="form-label">Admin Password:</label>
        <input type="password" class="form-control" id="password" name="password" required>
    </div>
    <div class="mb-3">
        <label for="employee_id" class="form-label">{{ adjust_form.employee_id.label }}</label>
        {{ adjust_form.employee_id(class="form-control", required=True) }}
    </div>
    <div class="mb-3">
        <label for="points" class="form-label">{{ adjust_form.points.label }}</label>
        {{ adjust_form.points(class="form-control", required=True) }}
    </div>
    <div class="mb-3">
        <label for="reason" class="form-label">{{ adjust_form.reason.label }}</label>
        {{ adjust_form.reason(class="form-control", required=True) }}
    </div>
    <div class="mb-3">
        <label for="notes" class="form-label">{{ adjust_form.notes.label }}</label>
        {{ adjust_form.notes(class="form-control") }}
    </div>
    {{ adjust_form.submit(class="btn btn-primary") }}
</form>

<script>
document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('quickAdjustForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const employeeId = document.getElementById('employee_id').value;
        const points = document.getElementById('points').value;
        const reason = document.getElementById('reason').value;
        if (!username || !password || !employeeId || !points || !reason) {
            alert('All required fields must be filled.');
            return;
        }
        fetch('/admin/quick_adjust_points', {
            method: 'POST',
            body: new FormData(this)
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            if (data.success) window.location.href = '/';
        })
        .catch(error => console.error('Error adjusting points:', error));
    });
});
</script>
{% endblock %}